(()=>{"use strict";var t={626:(t,n,i)=>{i.d(n,{X:()=>u,Z:()=>h});var e=document.getElementById("countdown-three"),s=document.getElementById("countdown-two"),r=document.getElementById("countdown-one"),o=document.getElementById("countdown-go");function h(){setTimeout((function(){e.classList.add("move-left")}),300),setTimeout((function(){s.classList.add("move-top")}),700),setTimeout((function(){r.classList.add("move-right")}),1100),setTimeout((function(){o.classList.add("move-down")}),1500)}function u(){e.classList.remove("move-left"),s.classList.remove("move-top"),r.classList.remove("move-right"),o.classList.remove("move-down")}},77:(t,n,i)=>{i.d(n,{DA:()=>c,JC:()=>u,Wu:()=>I,QI:()=>x,Ym:()=>C,xv:()=>E});var e=i(177),s=function(){function t(t,n,i){void 0===n&&(n=!1),this.t=t,this.isReady=n,this.color=i||"#000000".replace(/0/g,(function(){return(~~(16*Math.random())).toString(16)})),this.snake=null}return t.prototype.toJSON=function(){return{username:this.username,isReady:this.isReady,color:this.color}},Object.defineProperty(t.prototype,"username",{get:function(){return this.t},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.snake=null},t}(),r=function(){function t(t,n,i,e){void 0===e&&(e=5),this.i={},this.h=t,this.u=n,this.l=e,i?this.i=i:this.addPlayer(n)}return t.prototype.addPlayer=function(t){return!(Object.keys(this.i).length>=this.l)&&(this.i[t.username]=t,!0)},t.prototype.removePlayer=function(t){delete this.i[t]},t.prototype.resetRoomForNewGame=function(){this.v=1,Object.values(this.i).forEach((function(t){t.reset()}))},Object.defineProperty(t.prototype,"host",{get:function(){return this.u},set:function(t){Object.keys(this.i).some((function(n){return n===t.username}))&&(this.u=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"players",{get:function(){return this.i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.h},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxSize",{get:function(){return this.l},set:function(t){t>0&&(this.l=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastWinner",{get:function(){return this.m},set:function(t){Object.keys(this.i).some((function(n){return n===t.username}))&&(this.m=t)},enumerable:!1,configurable:!0}),t}(),o=i(440),h=i(626),u=null,c=null,a=document.getElementById("roomCodeInput"),f=document.getElementById("usernameInput"),l=document.getElementById("joinButton"),b=document.getElementById("readyButton"),d=document.getElementById("login-div"),v=document.getElementById("room-div"),w=document.getElementById("game-canvas-container"),m=document.getElementById("endgame-div"),p=document.getElementById("color-picker"),g=document.getElementById("room-users-list"),O=document.getElementById("room-code"),M=document.getElementById("player-count"),j=document.getElementById("color-picker-container"),y=document.getElementById("start-progress-bar"),_=document.getElementById("last-winner"),A=(document.getElementById("room-settings-button"),document.getElementById("settings-div")),k=document.getElementById("color-label");function S(){""===f.value.trim()?l.disabled=!0:l.disabled=!1,5===a.value.trim().length?l.textContent="JOIN ROOM":l.textContent="CREATE ROOM"}function T(t){t?(b.classList.remove("red-button"),b.classList.add("green-button")):(b.classList.add("red-button"),b.classList.remove("green-button"))}function x(t){var n=JSON.parse(t.toString()).room,i={};Object.keys(n.players).forEach((function(t){var e=n.players[t];i[t]=new s(t,e.isReady,e.color)})),u=new r(n.code,new s(n.host.username,n.host.isReady,n.host.color),i,n.maxSize),c.username===u.host.username&&document.getElementById("startButton").classList.remove("display-none"),j.style.backgroundColor=c.color,p.value=c.color,document.getElementById("color-label").style.color=F(p.value,"#FFFFFF","#000000"),d.classList.add("display-none"),v.classList.add("display-flex"),a.value=u.code,O.innerHTML=u.code,(0,o.AQ)(c,u.code),E(t)}function E(t){var n=JSON.parse(t.toString()).room;Object.keys(n.players).forEach((function(t){null==u.players[t]?u.addPlayer(new s(t,!1,n.players[t].color)):(u.players[t].color=n.players[t].color,u.players[t].isReady=n.players[t].isReady)})),Object.keys(u.players).forEach((function(t){n.players.hasOwnProperty(t)||u.removePlayer(t)})),u.host=new s(n.host.username,n.host.isReady,n.host.color),u.maxSize=n.maxSize,M.innerHTML="".concat(Object.keys(u.players).length,"/").concat(u.maxSize),g.innerHTML="",Object.values(u.players).forEach((function(t){var n=document.createElement("li");n.textContent=t.username+"",t.username===u.host.username?n.insertAdjacentHTML("afterbegin",'<i class="fa-solid fa-crown" style="color: '.concat(t.color,';"></i>')):n.insertAdjacentHTML("afterbegin",'<i class="fa-solid fa-circle" style="color: '.concat(t.color,'; margin-left: 4px"></i>')),t.isReady?n.insertAdjacentHTML("beforeend",' <i class="fa-solid fa-circle" style="color: #37cb48;"></i>'):n.insertAdjacentHTML("beforeend",' <i class="fa-solid fa-circle" style="color: #cb3737;"></i>'),g.appendChild(n)})),c.username===u.host.username&&document.getElementById("startButton").classList.remove("display-none"),function(t,n){if(0===n)return;y.style.clipPath="inset(0 ".concat(100-Math.floor(t/n*100)+"%"," 0 0")}(Object.values(u.players).filter((function(t){return t.isReady})).length,u.maxSize)}function I(t){l.classList.add("red-button"),l.classList.add("wiggle"),setTimeout((function(){l.classList.remove("red-button"),l.classList.remove("wiggle")}),600)}function R(t){k.style.opacity=t?"100":"0"}function F(t,n,i){var e="#"===t.charAt(0)?t.substring(1,7):t,s=[parseInt(e.substring(0,2),16)/255,parseInt(e.substring(2,4),16)/255,parseInt(e.substring(4,6),16)/255].map((function(t){return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}));return.2126*s[0]+.7152*s[1]+.0722*s[2]>.4?i:n}function C(t){switch(t.state){case 0:d.classList.add("display-none"),v.classList.add("display-none"),v.classList.remove("display-flex"),w.classList.remove("display-none"),w.classList.add("display-flex"),(0,e.Pp)(),document.getElementById("login-screen-body").style.overflow="hidden";break;case 1:d.classList.add("display-none"),d.classList.remove("display-flex"),v.classList.add("display-flex"),m.classList.add("display-none"),m.classList.remove("display-flex"),document.getElementById("login-screen-body").style.overflow="visible";break;case 2:_.innerHTML="".concat(u.lastWinner.username),w.classList.add("display-none"),w.classList.remove("display-flex"),m.classList.add("display-flex"),document.getElementById("login-screen-body").style.overflow="visible"}}document.addEventListener("DOMContentLoaded",(function(){S(),navigator.userAgent.toLowerCase().includes("firefox")||(p.onblur=function(){R(!0)})})),window.updateButton=S,window.handleRoomAction=function(){var t=f.value;t&&(c=new s(t),"CREATE ROOM"===l.innerText?(0,o.ab)(f.value):(0,o.O3)(a.value.toUpperCase(),f.value))},window.handleReadyState=function(){c.isReady=!c.isReady,(0,o.AQ)(c,u.code),T(c.isReady)},window.updateColorPicker=function(){j.style.backgroundColor=p.value},window.updatePlayerColor=function(){c.color=p.value,k.style.color=F(p.value,"#FFFFFF","#000000"),R(!0),(0,o.AQ)(c,u.code)},window.startGame=function(){c.username==u.host.username&&(0,o.w4)(u.code)},window.goBackToLobby=function(){C({type:"GAME_STATE",state:1}),u.resetRoomForNewGame(),c.snake=null,c.isReady=!1,T(c.isReady),(0,h.X)()},window.toggleSettingsDisplay=function(){A.classList.toggle("display-none")},window.changeColorPickerLabelState=R},440:(t,n,i)=>{i.d(n,{AQ:()=>u,O3:()=>h,Uj:()=>c,ab:()=>o,w4:()=>a});var e,s=i(177),r=i(77);function o(t){e&&e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({type:"CREATE_ROOM",username:t}))}function h(t,n){e&&e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({type:"JOIN_ROOM",roomCode:t,username:n}))}function u(t,n){e&&e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({type:"PLAYER_DATA",player:t,roomCode:n}))}function c(t,n){e&&e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({type:"KEY_EVENT",roomCode:r.JC.code,username:r.DA.username,key:t,pressed:n}))}function a(t){e&&e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({type:"BEGIN_GAME",roomCode:t}))}(e=new WebSocket("wss://snakegame-server.maxio.site")).onopen=function(){},e.onmessage=function(t){var n=JSON.parse(t.data);switch(n.type){case"JOINED_ROOM":(0,r.QI)(t.data);break;case"JOIN_FAIL":(0,r.Wu)(n.reason);break;case"ROOM_DATA":(0,r.xv)(t.data);break;case"GAME_STATE":(0,r.Ym)(n);break;case"GAMEPLAY_DATA":(0,s.XK)(n);break;case"ERROR":alert("Error: ".concat(n.message))}},e.onclose=function(){},e.onerror=function(t){}},177:(t,n,i)=>{i.d(n,{Ze:()=>G,K7:()=>z,jG:()=>L,C0:()=>B,oZ:()=>K,Pp:()=>Z,XK:()=>$});var e=i(565);function s(){var t=z.canvas.width/2e3,n=z.canvas.height/2e3;z.clearRect(0,0,G.width,G.height),z.strokeStyle="rgba(0, 0, 0, 0.3)",z.lineWidth=2;for(var i=K*t;i<G.width;i+=K*t)z.beginPath(),z.moveTo(i,0),z.lineTo(i,G.height),z.stroke();for(var e=K*n;e<G.height;e+=K*n)z.beginPath(),z.moveTo(0,e),z.lineTo(G.width,e),z.stroke()}function r(t,n,i,s,r){if(n.x!=i.x&&n.y!=i.y){var o=Math.atan2(i.y-n.y,i.x-n.x),h=10,u=new e.Vector(i.x,i.y);u.x-=Math.cos(o)*(1.15*r),u.y-=Math.sin(o)*(1.15*r),t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(u.x,u.y),t.strokeStyle=s,t.lineWidth=r,t.stroke(),t.beginPath(),t.moveTo(u.x,u.y),t.lineTo(u.x-h*Math.cos(o-Math.PI/7),u.y-h*Math.sin(o-Math.PI/7)),t.lineTo(u.x-h*Math.cos(o+Math.PI/7),u.y-h*Math.sin(o+Math.PI/7)),t.lineTo(u.x,u.y),t.lineTo(u.x-h*Math.cos(o-Math.PI/7),u.y-h*Math.sin(o-Math.PI/7)),t.strokeStyle=s,t.lineWidth=r,t.stroke(),t.fillStyle=s,t.fill(),t.closePath()}}const o=function(){};var h,u=(h=function(t,n){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},h(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}h(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});const c=function(t){function n(n,i,e,s,r,o){var h=t.call(this)||this;return h.center=n,h.radius=i,h.startAngle=e,h.endAngle=s,h.p=r,h.isCollidable=o,h}return u(n,t),n.prototype.draw=function(t,n){var i=t.canvas.width/2e3,e=t.canvas.height/2e3;t.lineCap="round",t.strokeStyle=n,!0===this.isCollidable&&(t.beginPath(),t.arc(this.center.x*i,this.center.y*e,this.radius*Math.min(i,e),this.startAngle,this.endAngle,this.p),t.stroke(),t.closePath())},n.prototype.drawDebug=function(t,n){var i,s,o,h,u=this.p?-Math.PI:Math.PI;u+=this.endAngle,t.lineCap="round",function(t,n,i,e){z.beginPath(),z.arc(t,n,i,0,2*Math.PI,!1),z.fillStyle=e,z.fill(),z.closePath()}(this.center.x,this.center.y,5,"#000000"),r(t,new e.Vector(this.endPoint.x,this.endPoint.y),new e.Vector(this.endPoint.x+this.radius*Math.cos(u),this.endPoint.y+this.radius*Math.sin(u)),"#bbbbbb",12),i=this.center.x,s=this.center.y,o=this.radius,h=!1,z.lineCap="round",z.strokeStyle="#3466aa",z.beginPath(),z.arc(i,s,o,0,2*Math.PI,h),z.lineWidth=5,z.stroke(),z.closePath()},Object.defineProperty(n.prototype,"endPoint",{get:function(){return new e.Vector(this.center.x+this.radius*Math.cos(this.endAngle),this.center.y+this.radius*Math.sin(this.endAngle))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"penpendicularEndAngle",{get:function(){return this.isCounterClockwise?this.endAngle-Math.PI/2:this.endAngle+Math.PI/2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"penpendicularStartAngle",{get:function(){return this.isCounterClockwise?this.startAngle-Math.PI/2:this.startAngle+Math.PI/2},enumerable:!1,configurable:!0}),n.prototype.isCounterClockwise=function(){return this.p},n.prototype.getContinuingSegment=function(t){return new n(this.center.clone().add(t),this.radius,this.endAngle,this.endAngle,this.p,this.isCollidable)},n}(o);var a=i(440);const f=function(){function t(t,n,i){this.O={},window.addEventListener("keydown",this.onKeyDown.bind(this)),window.addEventListener("keyup",this.onKeyUp.bind(this)),this.M=t,this.j=n.map((function(t){return t.toUpperCase()})),this._=i.map((function(t){return t.toUpperCase()}))}return t.prototype.onKeyDown=function(t){var n=this;if(this.M.isAlive){var i=t.key.toUpperCase();if(this.j.includes(i)||this._.includes(i)){if(this.j.some((function(t){return n.O[t]}))&&this._.includes(i))this.j.forEach((function(t){return n.O[t]=!1}));else if(this._.some((function(t){return n.O[t]}))&&this.j.includes(i))this._.forEach((function(t){return n.O[t]=!1}));else if(this.O[i])return;this.O[i]=!0,(0,a.Uj)(this._.includes(i)?1:0,!0)}}},t.prototype.onKeyUp=function(t){if(this.M.isAlive){var n=t.key.toUpperCase();this.O[n]&&(this.O[n]=!1,(0,a.Uj)(this._.includes(n)?1:0,!1))}},t.prototype.dispose=function(){window.removeEventListener("keydown",this.onKeyDown.bind(this)),window.removeEventListener("keyup",this.onKeyUp.bind(this))},t}();var l=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},t(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function e(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}();const b=function(t){function n(n,i,e,s){var r=t.call(this)||this;return r.isCollidable=!0,r.startPoint=n,r.endPoint=i,r.isCollidable=e,r.endAngle=s,r}return l(n,t),n.prototype.draw=function(t,n){var i=t.canvas.width/2e3,e=t.canvas.height/2e3;t.strokeStyle=n,t.lineCap="round",!0===this.isCollidable&&(t.beginPath(),t.moveTo(this.startPoint.x*i,this.startPoint.y*e),t.lineTo(this.endPoint.x*i,this.endPoint.y*e),t.stroke(),t.closePath())},Object.defineProperty(n.prototype,"length",{get:function(){return Math.sqrt(Math.pow(this.startPoint.x-this.endPoint.x,2)+Math.pow(this.startPoint.y-this.endPoint.y,2))},enumerable:!1,configurable:!0}),n.prototype.getContinuingSegment=function(t){var i=this.endPoint.clone().add(t);return new n(i,i,this.isCollidable,this.endAngle)},n}(o);function d(t,n){var i;return function(t){return new e.Vector(Math.cos(t),Math.sin(t))}((i=t,Math.atan2(i.y,i.x)+(Math.random()-.5)*n))}function v(t,n){var i;do{i=new e.Vector(Math.random()*t*2-t,Math.random()*t*2-t)}while(Math.pow(i.x,2)+Math.pow(i.y,2)>Math.pow(t,2));return n&&i.normalise().mulS(t),i}function w(t){var n=0,i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(t);return n=void 0===i[4]?1:parseInt(i[4],16)/255,i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16),a:n}:null}var m=function(){return m=Object.assign||function(t){for(var n,i=1,e=arguments.length;i<e;i++)for(var s in n=arguments[i])Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);return t},m.apply(this,arguments)};const p=function(){function t(t,n,i,e,s,r,o,h,u,c,a){void 0===s&&(s="circle"),this.A=t,this.k=n,this.S=h,this.T=r.a/this.S,this.I=i/this.S,"reverse"===a?(this.R=0,this.F=m(m({},function(t){return{r:t.r,g:t.g,b:t.b}}(r)),{a:0})):(this.R=i,this.F=r),this.C=e,this.N=s,this.J=o,this.P=u,this.W=c,this.D=a}return t.prototype.tick=function(t){this.A.add(this.k.clone().multiplyByScalar(t*this.C)),this.P&&("normal"===this.D?this.F.a-=this.T:this.F.a+=this.T),this.W&&("normal"===this.D?this.R-=this.I:this.R+=this.I),this.S--},t.prototype.draw=function(){var t=this.J.canvas.width/2e3,n=this.J.canvas.height/2e3;switch(this.J.moveTo(this.A.x*t,this.A.y*n),this.J.fillStyle="rgba(".concat(this.F.r,",").concat(this.F.g,", ").concat(this.F.b,", ").concat(this.F.a,")"),this.J.beginPath(),this.N){case"circle":this.J.arc(this.A.x*t,this.A.y*n,this.R,0,2*Math.PI),this.J.fill();break;case"square":this.J.fillRect((this.A.x-this.R)*t,(this.A.y-this.R)*n,2*this.R,2*this.R)}this.J.closePath()},Object.defineProperty(t.prototype,"age",{get:function(){return this.S},enumerable:!1,configurable:!0}),t}();var g=function(){function t(t,n,i){var s=i.emitInterval,r=void 0===s?2:s,o=i.emitAmountPerTick,h=void 0===o?5:o,u=i.particleSize,c=void 0===u?10:u,a=i.speed,f=void 0===a?2:a,l=i.particleShape,b=void 0===l?"circle":l,d=i.color,v=void 0===d?"#ffffffff":d,w=i.doFadeColor,m=void 0===w||w,p=i.doFadeSize,g=void 0===p||p,O=i.fadeDirection,M=void 0===O?"normal":O,j=i.particleAge,y=void 0===j?50:j,_=i.emitTimeMillis,A=void 0===_?0:_,k=i.drawEmitterZone,S=void 0!==k&&k,T=i.emitDirection,x=void 0===T?new e.Vector(0,0):T,E=i.spreadAngle,I=void 0===E?2*Math.PI:E,R=i.spawnParticlesOnEdge,F=void 0!==R&&R;this.L=[],this.B=0,this.position=t,this.J=n,this.G=r,this.Y=h,this.K=c,this.C=f,this.q=b,this.F=v,this.U=m,this.$=g,this.D=M,this.H=y,this.V=I,this.tt=A,this.emitDirection=x,this.nt=S,this.it=F}return Object.defineProperty(t.prototype,"emitTime",{set:function(t){this.tt=t},enumerable:!1,configurable:!0}),t}();const O=g;var M=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},t(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function e(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}(),j=function(){return j=Object.assign||function(t){for(var n,i=1,e=arguments.length;i<e;i++)for(var s in n=arguments[i])Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);return t},j.apply(this,arguments)};const y=function(t){function n(n,i,e,s){var r=t.call(this,i,e,s)||this;return r.et=n,r}return M(n,t),n.prototype.tick=function(t){if(!(this.tt+this.H<0)){if(this.tt-=t,this.B%this.G==0&&this.tt>0)for(var n=this.J.canvas.height/2e3,i=0;i<this.Y;i++)this.L.push(new p(this.position.clone().add(v(this.et,this.it)),d(this.emitDirection,this.V),this.K*n,this.C,this.q,j({},w(this.F)),this.J,this.H,this.U,this.$,this.D));this.L.forEach((function(n){n.tick(t)})),this.L=this.L.filter((function(t){return t.age>0})),this.B++}},n.prototype.draw=function(){if(!(this.tt+this.H<0)){if(!0===this.nt){var t=w(this.F),n=this.J.canvas.width/2e3,i=this.J.canvas.height/2e3;this.J.moveTo(this.position.x*n,this.position.y*i),this.J.fillStyle="rgba(".concat(t.r,",").concat(t.g,",").concat(t.b,", ").concat(Math.min(.2,(this.tt+this.H)/this.H/5),")"),this.J.beginPath(),this.J.arc(this.position.x*n,this.position.y*i,this.et,0,2*Math.PI),this.J.fill(),this.J.closePath()}this.L.forEach((function(t){t.draw()}))}},Object.defineProperty(n.prototype,"emitTime",{set:function(t){this.tt=t},enumerable:!1,configurable:!0}),n}(O);const _=function(){function t(t,n,i){this.segments=[],this.isAlive=!0,this.turnRadius=60,this.st=null,this.addSegment(t),this.F=n,this.J=i,this.st=new y(0,this.head.endPoint,this.J,{emitInterval:2,emitAmountPerTick:3,particleSize:7,speed:4,color:this.F})}return t.prototype.addSegment=function(t){this.segments.push(t)},Object.defineProperty(t.prototype,"head",{get:function(){return this.segments.slice(-1).pop()},enumerable:!1,configurable:!0}),t.prototype.draw=function(){var t=this,n=this.J.canvas.width/2e3,i=this.J.canvas.height/2e3;this.J.lineWidth=12*Math.min(n,i),this.segments.forEach((function(e,s){e.draw(t.J,t.F),t.head===e&&(t.J.beginPath(),t.J.arc(e.endPoint.x*n,e.endPoint.y*i,.5*Math.min(n,i),0,2*Math.PI),t.J.stroke(),t.J.closePath())}))},t.prototype.drawHeadingDir=function(){var t=this.J.canvas.width/2e3,n=this.J.canvas.height/2e3,i=this.head,s=170*Math.cos(i.endAngle),o=170*Math.sin(i.endAngle),h=12*Math.min(t,n),u=new e.Vector(i.endPoint.x+s,i.endPoint.y+o);r(this.J,this.head.endPoint.clone().mulS(t),u.mulS(t),this.F,.6*h)},t.prototype.kill=function(){this.isAlive=!1,this.st.position=this.head.endPoint,this.st.emitTime=10},t.prototype.updateEmitter=function(t){this.st&&(this.st.tick(t),this.st.draw())},t}();var A=i(77),k=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},t(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function e(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}(),S=function(){return S=Object.assign||function(t){for(var n,i=1,e=arguments.length;i<e;i++)for(var s in n=arguments[i])Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);return t},S.apply(this,arguments)};const T=function(t){function n(n,i,e,s,r){var o=t.call(this,e,s,r)||this;return o.rt=n,o.ot=i,o}return k(n,t),n.prototype.tick=function(t){if(!(this.tt+this.H<0)){if(this.tt-=t,this.B%this.G==0&&this.tt>0)for(var n=this.J.canvas.height/2e3,i=0;i<this.Y;i++)this.L.push(new p(this.position.clone().add((s=this.rt,r=this.ot,new e.Vector(Math.random()*s,Math.random()*r)).subtract(new e.Vector(this.rt/2,this.ot/2))),d(this.emitDirection,this.V),this.K*n,this.C,this.q,S({},w(this.F)),this.J,this.H,this.U,this.$,this.D));var s,r;this.L.forEach((function(n){n.tick(t)})),this.L=this.L.filter((function(t){return t.age>0})),this.B++}},n.prototype.draw=function(){if(!(this.tt+this.H<0)){if(!0===this.nt){var t=this.J.canvas.width/2e3,n=this.J.canvas.height/2e3;this.J.moveTo((this.position.x-this.rt/2)*t,(this.position.y-this.ot/2)*n),this.J.fillStyle="rgba(".concat((i=this.F,e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i),e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null),", ").concat(Math.min(.2,(this.tt+this.H)/this.H/5),")"),this.J.beginPath(),this.J.rect(this.position.x-this.rt/2,this.position.y-this.ot/2,this.rt,this.ot),this.J.fill(),this.J.closePath()}var i,e;this.L.forEach((function(t){t.draw()}))}},Object.defineProperty(n.prototype,"emitTime",{set:function(t){this.tt=t},enumerable:!1,configurable:!0}),n}(O);var x,E;!function(t){t[t.SpeedUp=0]="SpeedUp",t[t.SpeedDown=1]="SpeedDown",t[t.Bomb=2]="Bomb",t[t.FlipButtons=3]="FlipButtons",t[t.Invisibility=4]="Invisibility",t[t.PortalWalls=5]="PortalWalls",t[t.CameraLockToPlayer=6]="CameraLockToPlayer"}(E||(E={}));var I=((x={})[E.SpeedUp]="../assets/powerups/speedup.svg",x[E.SpeedDown]="../assets/powerups/speeddown.svg",x[E.Bomb]="../assets/powerups/bomb.svg",x[E.FlipButtons]="../assets/powerups/flipbuttons.svg",x[E.Invisibility]="../assets/powerups/invisibility.svg",x[E.PortalWalls]="../assets/powerups/portalwalls.svg",x[E.CameraLockToPlayer]="../assets/powerups/temp.svg",x);const R=function(){function t(t,n,i,e,s,r){this.ht=30,this.ut=t,this.A=n,this.J=i,this.F=e,this.ct=s,this.ft=r,this.lt=new Image,this.lt.src=I[this.ct],this.st=new y(.6*this.ht,this.A,this.J,{color:this.F,particleSize:this.ht/2.85,particleAge:60,speed:this.ht/20,emitAmountPerTick:3,spawnParticlesOnEdge:!0})}return t.prototype.draw=function(){this.st.tick(.5),this.st.draw();var t=this.J.canvas.width/2e3,n=this.J.canvas.height/2e3;this.J.moveTo(this.A.x*t,this.A.y*n),this.J.fillStyle=this.F,this.J.beginPath(),this.J.arc(this.A.x*t,this.A.y*n,this.ht*t,0,2*Math.PI),this.J.fill(),this.J.closePath(),this.drawSVG(),this.st.emitTime=1/0},t.prototype.drawSVG=function(){var t=this.J.canvas.width/2e3,n=this.J.canvas.height/2e3,i=.6,e=this.lt.width/this.lt.height,s=2*this.ht*i*t,r=2*this.ht*i*t/e;r>2*this.ht*i*t&&(s=(r=2*this.ht*i*t)*e),this.J.drawImage(this.lt,this.A.x*t-s/2,this.A.y*n-r/2,s,r)},Object.defineProperty(t.prototype,"id",{get:function(){return this.ut},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.A},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this.ht},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.ct},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.F},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.ft},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{id:this.ut,position:{x:this.position.x,y:this.position.y},color:this.F,type:this.ct,radius:this.ht,duration:this.ft}},t.fromMessagePowerup=function(n,i){return new t(n.powerup.id,new e.Vector(n.powerup.position.x,n.powerup.position.y),i,n.powerup.color,n.powerup.type,n.powerup.duration)},t}();var F=function(){function t(){this.bt={},this.dt=[],this.vt=!1,this.wt=!1,this.gt=document.getElementById("game-canvas-container"),this.initializeWallEmitters()}return t.prototype.initializeWallEmitters=function(){for(var t=[new e.Vector(2e3,50),new e.Vector(50,2e3),new e.Vector(2e3,50),new e.Vector(50,2e3)],n=[new e.Vector(0,-1),new e.Vector(-1,0),new e.Vector(0,1),new e.Vector(1,0)],i=[new e.Vector(1e3,50),new e.Vector(50,1e3),new e.Vector(1e3,1950),new e.Vector(1950,1e3)],s=0;s<4;s++)this.dt.push(new T(t[s].x,t[s].y,i[s],B,{particleShape:"square",color:"#59eeebff",emitTimeMillis:0,emitDirection:n[s],spreadAngle:Math.PI/6,speed:.8,particleSize:8,particleAge:100,emitInterval:1,emitAmountPerTick:4,fadeDirection:"reverse"}))},t.prototype.addPowerup=function(t){this.bt[t.id]=t},t.prototype.removePowerup=function(t){delete this.bt[t.id]},t.prototype.applyPowerup=function(t,n){var i=this;switch(t.type){case E.PortalWalls:this.flipWallState(),setTimeout((function(){i.flipWallState()}),t.duration);break;case E.CameraLockToPlayer:if(n.username===A.DA.username||!A.DA.snake.isAlive)break;this.wt=!0,L.width=2*L.getBoundingClientRect().width,L.height=2*L.getBoundingClientRect().height,G.width=2*G.getBoundingClientRect().width,G.height=2*G.getBoundingClientRect().height,s(),setTimeout((function(){i.wt=!1,document.getElementById("game-canvas-container").style.transform="scale(1) rotate(0rad) translate(0px, 0px)",setTimeout((function(){Z()}),200)}),t.duration)}this.removePowerup(t)},t.prototype.generateZones=function(t,n){},t.prototype.draw=function(){Object.values(this.bt).forEach((function(t){t.draw()})),this.dt.forEach((function(t){t.tick(1),t.draw()}))},t.prototype.flipWallState=function(){var t=this;this.vt=!this.vt,this.dt.forEach((function(n){return n.emitTime=t.vt?1/0:0})),this.gt.style.borderColor=this.vt?"#34c6dc":"#555555"},Object.defineProperty(t.prototype,"cameraLock",{get:function(){return this.wt},enumerable:!1,configurable:!0}),t}();const C=F;var N=i(626),J=document.getElementById("game-canvas-container"),P=document.createElement("div");P.style.position="absolute",P.style.top="10px",P.style.left="10px",P.style.color="black";var W=0;document.body.appendChild(P);var D=60,L=document.getElementById("game-canvas"),B=L.getContext("2d"),G=document.getElementById("background-canvas"),z=G.getContext("2d");G.width=G.getBoundingClientRect().width,G.height=G.getBoundingClientRect().height,L.width=L.getBoundingClientRect().width,L.height=L.getBoundingClientRect().height;var Y,K=66.666;function Z(){L.width=1.5*L.getBoundingClientRect().width,L.height=1.5*L.getBoundingClientRect().height,G.width=1.5*G.getBoundingClientRect().width,G.height=1.5*G.getBoundingClientRect().height,s()}function q(){++Q%10==0&&(D=function(){var t=performance.now()/10,n=t-U,i=Math.round(1e3/n);return U=t,i}(),P.innerText="FPS: ".concat(D)),B.clearRect(0,0,L.width,L.height),Object.values(A.JC.players).forEach((function(t){t.snake.draw(),t.snake.updateEmitter((performance.now()/10-U)/15)})),Y.draw()}var Q=0,U=performance.now()/10;function X(t,n){var i=2*Math.PI,e=(n-t)%i;return e>Math.PI?e-=i:e<-Math.PI&&(e+=i),t+e}function $(t){if(null===A.DA.snake)return t.snakeHeads.forEach((function(t){var n=t.lastSegment,i=t.username,s=n.endPoint;A.JC.players[i].snake=new _(new b(new e.Vector(s.x,s.y),new e.Vector(s.x,s.y),n.isCollidable,n.endAngle),A.JC.players[i].color,B)})),A.DA.snake=A.JC.players[A.DA.username].snake,new f(A.JC.players[A.DA.username].snake,["A","ARROWLEFT"],["D","ARROWRIGHT"]),Y=new C,(0,N.Z)(),q(),void Object.values(A.JC.players).forEach((function(t){t.snake.drawHeadingDir()}));var n=[];t.snakeHeads.forEach((function(i){var s=i.lastSegment,r=i.username,o=s.endPoint,h=A.JC.players[r].snake;if(null!==t.powerupList&&t.powerupList.forEach((function(t){switch(t.action){case 0:Y.removePowerup(R.fromMessagePowerup(t,B));break;case 1:Y.addPowerup(R.fromMessagePowerup(t,B));break;case 2:Y.applyPowerup(R.fromMessagePowerup(t,B),t.player)}})),n.push(r),s.isNewThisTick){if("LineSegment"===i.segmentType){var u=s.startPoint;h.addSegment(new b(new e.Vector(u.x,u.y),new e.Vector(o.x,o.y),s.isCollidable,s.endAngle))}else if("ArcSegment"===i.segmentType){var a=s.center;h.addSegment(new c(new e.Vector(a.x,a.y),s.radius,s.startAngle,s.endAngle,s.counterClockwise,s.isCollidable))}}else if("LineSegment"===i.segmentType){if(Y.cameraLock&&r===A.DA.username){var f=-s.endAngle-Math.PI/2,l=X(W,f);J.style.transform="scale(2) rotate(".concat(l,"rad) translate(").concat(-s.endPoint.x*window.innerHeight/2e3+window.innerHeight/2,"px, ").concat(-s.endPoint.y*window.innerHeight/2e3+window.innerHeight/2,"px)"),W=l}u=s.startPoint;h.segments[h.segments.length-1]=new b(new e.Vector(u.x,u.y),new e.Vector(o.x,o.y),s.isCollidable,s.endAngle)}else if("ArcSegment"===i.segmentType){if(Y.cameraLock&&r===A.DA.username){f=s.counterClockwise?-s.endAngle:-s.endAngle-Math.PI,l=X(W,f);J.style.transform="scale(2) rotate(".concat(l,"rad) translate(").concat(-s.endPoint.x*window.innerHeight/2e3+window.innerHeight/2,"px, ").concat(-s.endPoint.y*window.innerHeight/2e3+window.innerHeight/2,"px)"),W=l}a=s.center;h.segments[h.segments.length-1]=new c(new e.Vector(a.x,a.y),s.radius,s.startAngle,s.endAngle,s.counterClockwise,s.isCollidable)}})),Object.values(A.JC.players).forEach((function(t){!n.includes(t.username)&&t.snake.isAlive&&(t.snake.kill(),!0===Object.values(A.JC.players).every((function(t){return!t.snake.isAlive}))&&(A.JC.lastWinner=t))})),q()}window.addEventListener("resize",Z),s()},120:(t,n)=>{Object.defineProperty(n,"Ot",{value:!0});var i=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10],e=function(){function t(t){this.ctor=t}return t.prototype.setAxes=function(t,n){return this.x=t,this.y=n,this},t.prototype.getX=function(){return this.x},t.prototype.setX=function(t){return this.x=t,this},t.prototype.getY=function(){return this.y},t.prototype.setY=function(t){return this.y=t,this},t.prototype.toString=function(t){return void 0===t&&(t=!1),t?"("+Math.round(this.x)+", "+Math.round(this.y)+")":"("+this.x+", "+this.y+")"},t.prototype.toArray=function(){return[this.x,this.y]},t.prototype.toObject=function(){return{x:this.x,y:this.y}},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.multiplyByVector=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.mulV=function(t){return this.multiplyByVector(t)},t.prototype.divideByVector=function(t){return this.x/=t.x,this.y/=t.y,this},t.prototype.divV=function(t){return this.divideByVector(t)},t.prototype.multiplyByScalar=function(t){return this.x*=t,this.y*=t,this},t.prototype.mulS=function(t){return this.multiplyByScalar(t)},t.prototype.divideByScalar=function(t){return this.x/=t,this.y/=t,this},t.prototype.divS=function(t){return this.divideByScalar(t)},t.prototype.normalise=function(){return this.divideByScalar(this.magnitude())},t.prototype.normalize=function(){return this.normalise()},t.prototype.unit=function(){return this.normalise()},t.prototype.magnitude=function(){var t=this.x,n=this.y;return Math.sqrt(t*t+n*n)},t.prototype.length=function(){return this.magnitude()},t.prototype.lengthSq=function(){var t=this.x,n=this.y;return t*t+n*n},t.prototype.dot=function(t){return t.x*this.x+t.y*this.y},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.abs=function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},t.prototype.zero=function(){return this.x=this.y=0,this},t.prototype.distance=function(t){var n=this.x-t.x,i=this.y-t.y;return Math.sqrt(n*n+i*i)},t.prototype.rotate=function(t){var n=Math.cos(t),i=Math.sin(t),e=this.x,s=this.y;return this.x=e*n-s*i,this.y=e*i+s*n,this},t.prototype.round=function(t){void 0===t&&(t=2);var n=i[t];return this.x=(.5+this.x*n<<0)/n,this.y=(.5+this.y*n<<0)/n,this},t.prototype.clone=function(){return new this.ctor(this.x,this.y)},t}();n.AbstractVector=e},51:function(t,n,i){var e,s=this&&this.Mt||(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])},function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});Object.defineProperty(n,"Ot",{value:!0});var r=function(t){function n(i,e){var s=t.call(this,n)||this;return s.axes=[i,e],s.ctor=n,s}return s(n,t),Object.defineProperty(n.prototype,"x",{get:function(){return this.axes[0]},set:function(t){this.axes[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.axes[1]},set:function(t){this.axes[1]=t},enumerable:!0,configurable:!0}),n}(i(120).AbstractVector);n.ArrayVector=r},725:function(t,n,i){var e,s=this&&this.Mt||(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])},function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});Object.defineProperty(n,"Ot",{value:!0});var r=function(t){function n(i,e){var s=t.call(this,n)||this;return s.axes=new Float32Array(2),s.axes[0]=i,s.axes[1]=e,s}return s(n,t),Object.defineProperty(n.prototype,"x",{get:function(){return this.axes[0]},set:function(t){this.axes[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.axes[1]},set:function(t){this.axes[1]=t},enumerable:!0,configurable:!0}),n}(i(120).AbstractVector);n.Float32Vector=r},565:(t,n,i)=>{function e(t){for(var i in t)n.hasOwnProperty(i)||(n[i]=t[i])}Object.defineProperty(n,"Ot",{value:!0}),e(i(120)),e(i(51)),e(i(725)),e(i(974))},974:function(t,n,i){var e,s=this&&this.Mt||(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])},function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});Object.defineProperty(n,"Ot",{value:!0});var r=function(t){function n(i,e){var s=t.call(this,n)||this;return s.jt=i,s.yt=e,s}return s(n,t),Object.defineProperty(n.prototype,"x",{get:function(){return this.jt},set:function(t){this.jt=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.yt},set:function(t){this.yt=t},enumerable:!0,configurable:!0}),n}(i(120).AbstractVector);n.Vector=r}},n={};function i(e){var s=n[e];if(void 0!==s)return s.exports;var r=n[e]={exports:{}};return t[e].call(r.exports,r,r.exports,i),r.exports}i.d=(t,n)=>{for(var e in n)i.o(n,e)&&!i.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},i.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);i(77)})();