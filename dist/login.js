/*! For license information please see login.js.LICENSE.txt */
(()=>{"use strict";var e={"./src/MenuManager/login.ts":(e,o,t)=>{t.r(o),t.d(o,{handleReadyState:()=>f,handleRoomAction:()=>b,showErrorAnimation:()=>p,showRoomView:()=>g,updateButton:()=>S,updateRoomList:()=>O});var n=t("./src/WebSocketClient/websocket.ts"),r=document.getElementById("roomCodeInput"),a=document.getElementById("usernameInput"),s=document.getElementById("joinButton"),c=document.getElementById("readyButton"),i=document.getElementById("login-div"),d=document.getElementById("room-div"),l=document.getElementById("room-users-list"),u=document.getElementById("room-title"),m=document.getElementById("player-count"),y=!1;function S(){""==a.value.trim()?s.disabled=!0:s.disabled=!1,5==r.value.trim().length?s.textContent="JOIN ROOM":s.textContent="CREATE ROOM"}function b(){"CREATE ROOM"===s.innerText?(0,n.createRoom)(a.value):(0,n.joinRoom)(r.value.toUpperCase(),a.value)}function f(){y=!y,(0,n.setReadyState)(a.value,r.value,y),y?(c.classList.remove("red-button"),c.classList.add("green-button")):(c.classList.add("red-button"),c.classList.remove("green-button"))}function g(e){var o=JSON.parse(e.toString());i.classList.add("display-none"),d.classList.add("display-flex"),r.value=o.room.code,u.innerHTML="WELCOME TO<br>".concat(o.room.code),O(e)}function O(e){var o=JSON.parse(e.toString()),t=o.room.players;m.innerHTML="".concat(t.length,"/").concat(o.room.maxSize),l.innerHTML="",t.forEach((function(e){var t=document.createElement("li");t.textContent=e.username+"",e.username==o.room.host.username&&t.insertAdjacentHTML("afterbegin",'<i class="fa-solid fa-crown" style="color: #ffd700;"></i>'),e.isReady?t.insertAdjacentHTML("beforeend",' <i class="fa-solid fa-circle" style="color: #37cb48;"></i>'):t.insertAdjacentHTML("beforeend",' <i class="fa-solid fa-circle" style="color: #cb3737;"></i>'),l.appendChild(t)}))}function p(){s.classList.add("red-button"),s.classList.add("wiggle"),setTimeout((function(){s.classList.remove("red-button"),s.classList.remove("wiggle")}),600)}window.onload=function(){S()},window.updateButton=S,window.handleRoomAction=b,window.handleReadyState=f},"./src/WebSocketClient/websocket.ts":(e,o,t)=>{t.r(o),t.d(o,{createRoom:()=>a,getReadyState:()=>i,joinRoom:()=>s,sendKeyEventToServer:()=>d,setReadyState:()=>c});var n,r=t("./src/MenuManager/login.ts");function a(e){n&&n.readyState===WebSocket.OPEN?n.send(JSON.stringify({type:"CREATE_ROOM",username:e})):console.error("WebSocket connection is not open")}function s(e,o){n&&n.readyState===WebSocket.OPEN?n.send(JSON.stringify({type:"JOIN_ROOM",roomCode:e,username:o})):console.error("WebSocket connection is not open")}function c(e,o,t){n&&n.readyState===WebSocket.OPEN?n.send(JSON.stringify({type:"SET_READY",username:e,roomCode:o,readyState:t})):console.error("WebSocket connection is not open")}function i(e){n&&n.readyState===WebSocket.OPEN?n.send(JSON.stringify({type:"GET_READY",username:e})):console.error("WebSocket connection is not open")}function d(e,o){n&&n.readyState===WebSocket.OPEN?n.send(JSON.stringify({type:"KEY_EVENT",key:e,pressed:o})):console.error("WebSocket connection is not open")}(n=new WebSocket("ws://".concat(window.location.hostname,":8080"))).onopen=function(){console.log("WebSocket connection established")},n.onmessage=function(e){var o=JSON.parse(e.data);switch(console.log("Message from server:",o),o.type){case"JOINED_ROOM":(0,r.showRoomView)(e.data);break;case"ROOM_DOES_NOT_EXIST":(0,r.showErrorAnimation)();break;case"ROOM_DATA":(0,r.updateRoomList)(e.data);break;case"GAMEPLAY":break;case"ERROR":alert("Error: ".concat(o.message))}},n.onclose=function(){console.log("WebSocket connection closed")},n.onerror=function(e){console.error("WebSocket error:",e)}}},o={};function t(n){var r=o[n];if(void 0!==r)return r.exports;var a=o[n]={exports:{}};return e[n](a,a.exports,t),a.exports}t.d=(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},t.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t("./src/MenuManager/login.ts")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VSxTQUFDZixHQUNkRCxRQUFRQyxNQUFNLG1CQUFvQkEsRUFDdEMsSUN2Q0FnQixFQUEyQixDQUFDLEVBR2hDLFNBQVNDLEVBQW9CQyxHQUU1QixJQUFJQyxFQUFlSCxFQUF5QkUsR0FDNUMsUUFBcUJFLElBQWpCRCxFQUNILE9BQU9BLEVBQWFFLFFBR3JCLElBQUlDLEVBQVNOLEVBQXlCRSxHQUFZLENBR2pERyxRQUFTLENBQUMsR0FPWCxPQUhBRSxFQUFvQkwsR0FBVUksRUFBUUEsRUFBT0QsUUFBU0osR0FHL0NLLEVBQU9ELE9BQ2YsQ0NyQkFKLEVBQW9CTyxFQUFJLENBQUNILEVBQVNJLEtBQ2pDLElBQUksSUFBSXJCLEtBQU9xQixFQUNYUixFQUFvQlMsRUFBRUQsRUFBWXJCLEtBQVNhLEVBQW9CUyxFQUFFTCxFQUFTakIsSUFDNUV1QixPQUFPQyxlQUFlUCxFQUFTakIsRUFBSyxDQUFFeUIsWUFBWSxFQUFNQyxJQUFLTCxFQUFXckIsSUFFMUUsRUNORGEsRUFBb0JTLEVBQUksQ0FBQ0ssRUFBS0MsSUFBVUwsT0FBT00sVUFBVUMsZUFBZUMsS0FBS0osRUFBS0MsR0NDbEZmLEVBQW9CbUIsRUFBS2YsSUFDSCxvQkFBWGdCLFFBQTBCQSxPQUFPQyxhQUMxQ1gsT0FBT0MsZUFBZVAsRUFBU2dCLE9BQU9DLFlBQWEsQ0FBRWpGLE1BQU8sV0FFN0RzRSxPQUFPQyxlQUFlUCxFQUFTLGFBQWMsQ0FBRWhFLE9BQU8sR0FBTyxFQ0ZwQzRELEVBQW9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc25ha2VfZ2FtZS8uL3NyYy9NZW51TWFuYWdlci9sb2dpbi50cyIsIndlYnBhY2s6Ly9zbmFrZV9nYW1lLy4vc3JjL1dlYlNvY2tldENsaWVudC93ZWJzb2NrZXQudHMiLCJ3ZWJwYWNrOi8vc25ha2VfZ2FtZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zbmFrZV9nYW1lL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9zbmFrZV9nYW1lL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vc25ha2VfZ2FtZS93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL3NuYWtlX2dhbWUvd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZVJvb20sIGdldFJlYWR5U3RhdGUsIGpvaW5Sb29tLCBzZXRSZWFkeVN0YXRlIH0gZnJvbSBcIi4uL1dlYlNvY2tldENsaWVudC93ZWJzb2NrZXRcIjtcclxuXHJcbmNvbnN0IHJvb21Db2RlSW5wdXQgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvb21Db2RlSW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50KTtcclxuY29uc3QgdXNlcm5hbWVJbnB1dCA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWVJbnB1dCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQpO1xyXG5jb25zdCByb29tQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2pvaW5CdXR0b24nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuY29uc3QgcmVhZHlCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVhZHlCdXR0b24nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuY29uc3QgbG9naW5EaXY9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbi1kaXYnKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuY29uc3Qgcm9vbURpdj0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvb20tZGl2JykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcbmNvbnN0IHJvb21Vc2Vyc0xpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm9vbS11c2Vycy1saXN0JykgYXMgSFRNTFVMaXN0RWxlbWVudDtcclxuY29uc3Qgcm9vbVRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvb20tdGl0bGUnKSBhcyBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuY29uc3QgcGxheWVyQ291bnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheWVyLWNvdW50JykgYXMgSFRNTFBhcmFncmFwaEVsZW1lbnQ7XHJcbmxldCBpc1JlYWR5ID0gZmFsc2U7XHJcbi8vIHNyYy9sb2dpbi50c1xyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQnV0dG9uKCkge1xyXG4gICAgXHJcblxyXG4gICAgaWYgKHVzZXJuYW1lSW5wdXQudmFsdWUudHJpbSgpID09ICcnKSB7XHJcbiAgICAgICAgcm9vbUJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJvb21CdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocm9vbUNvZGVJbnB1dC52YWx1ZS50cmltKCkubGVuZ3RoID09IDUpIHtcclxuICAgICAgICByb29tQnV0dG9uLnRleHRDb250ZW50ID0gJ0pPSU4gUk9PTSc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJvb21CdXR0b24udGV4dENvbnRlbnQgPSAnQ1JFQVRFIFJPT00nO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlUm9vbUFjdGlvbigpIHtcclxuICAgIGlmIChyb29tQnV0dG9uLmlubmVyVGV4dCA9PT0gJ0NSRUFURSBST09NJykge1xyXG4gICAgICAgIGNyZWF0ZVJvb20odXNlcm5hbWVJbnB1dC52YWx1ZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGpvaW5Sb29tKHJvb21Db2RlSW5wdXQudmFsdWUudG9VcHBlckNhc2UoKSwgdXNlcm5hbWVJbnB1dC52YWx1ZSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVSZWFkeVN0YXRlKCkge1xyXG4gICAgaXNSZWFkeSA9ICFpc1JlYWR5O1xyXG4gICAgc2V0UmVhZHlTdGF0ZSh1c2VybmFtZUlucHV0LnZhbHVlLCByb29tQ29kZUlucHV0LnZhbHVlLCBpc1JlYWR5KVxyXG4gICAgaWYoaXNSZWFkeSl7XHJcbiAgICAgICAgcmVhZHlCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgncmVkLWJ1dHRvbicpO1xyXG4gICAgICAgIHJlYWR5QnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2dyZWVuLWJ1dHRvbicpO1xyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgICByZWFkeUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdyZWQtYnV0dG9uJyk7XHJcbiAgICAgICAgcmVhZHlCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnZ3JlZW4tYnV0dG9uJyk7XHJcbiAgICB9XHJcbiAgICBcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dSb29tVmlldyhkYXRhOiBKU09OKXtcclxuICAgIFxyXG4gICAgbGV0IHJvb21JbmZvID0gSlNPTi5wYXJzZShkYXRhLnRvU3RyaW5nKCkpO1xyXG4gICAgbG9naW5EaXYuY2xhc3NMaXN0LmFkZCgnZGlzcGxheS1ub25lJyk7XHJcbiAgICByb29tRGl2LmNsYXNzTGlzdC5hZGQoJ2Rpc3BsYXktZmxleCcpO1xyXG4gICAgcm9vbUNvZGVJbnB1dC52YWx1ZSA9IHJvb21JbmZvWydyb29tJ11bJ2NvZGUnXTtcclxuICAgIHJvb21UaXRsZS5pbm5lckhUTUwgID0gYFdFTENPTUUgVE88YnI+JHtyb29tSW5mb1sncm9vbSddWydjb2RlJ119YDtcclxuICAgIHVwZGF0ZVJvb21MaXN0KGRhdGEpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlUm9vbUxpc3QoZGF0YTogSlNPTil7XHJcbiAgICBsZXQgcm9vbUluZm8gPSBKU09OLnBhcnNlKGRhdGEudG9TdHJpbmcoKSk7XHJcbiAgICBsZXQgcGxheWVycyA9IHJvb21JbmZvWydyb29tJ11bJ3BsYXllcnMnXTtcclxuICAgIHBsYXllckNvdW50LmlubmVySFRNTCA9IGAke3BsYXllcnMubGVuZ3RofS8ke3Jvb21JbmZvWydyb29tJ11bJ21heFNpemUnXX1gO1xyXG4gICAgcm9vbVVzZXJzTGlzdC5pbm5lckhUTUwgPSAnJztcclxuXHJcbiAgICBwbGF5ZXJzLmZvckVhY2goKHBsYXllcjogeyB1c2VybmFtZTogc3RyaW5nIHwgbnVtYmVyOyBpc1JlYWR5OiBib29sZWFuOyB9KSA9PiB7XHJcbiAgICAgICAgY29uc3QgcGxheWVySXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcblxyXG4gICAgICAgIHBsYXllckl0ZW0udGV4dENvbnRlbnQgPSBwbGF5ZXIudXNlcm5hbWUgKyAnJztcclxuICAgICAgICBcclxuICAgICAgICBpZihwbGF5ZXIudXNlcm5hbWUgPT0gcm9vbUluZm9bJ3Jvb20nXVsnaG9zdCddWyd1c2VybmFtZSddKSB7XHJcbiAgICAgICAgICAgIHBsYXllckl0ZW0uaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlcmJlZ2luJywgJzxpIGNsYXNzPVwiZmEtc29saWQgZmEtY3Jvd25cIiBzdHlsZT1cImNvbG9yOiAjZmZkNzAwO1wiPjwvaT4nKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChwbGF5ZXIuaXNSZWFkeSkge1xyXG4gICAgICAgICAgICBwbGF5ZXJJdGVtLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgJyA8aSBjbGFzcz1cImZhLXNvbGlkIGZhLWNpcmNsZVwiIHN0eWxlPVwiY29sb3I6ICMzN2NiNDg7XCI+PC9pPicpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBsYXllckl0ZW0uaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCAnIDxpIGNsYXNzPVwiZmEtc29saWQgZmEtY2lyY2xlXCIgc3R5bGU9XCJjb2xvcjogI2NiMzczNztcIj48L2k+Jyk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgcm9vbVVzZXJzTGlzdC5hcHBlbmRDaGlsZChwbGF5ZXJJdGVtKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2hvd0Vycm9yQW5pbWF0aW9uKCkge1xyXG4gICAgcm9vbUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdyZWQtYnV0dG9uJyk7XHJcbiAgICByb29tQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3dpZ2dsZScpO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICByb29tQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ3JlZC1idXR0b24nKTtcclxuICAgIHJvb21CdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnd2lnZ2xlJyk7XHJcbiAgICB9LCA2MDApXHJcbn1cclxuXHJcbndpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICB1cGRhdGVCdXR0b24oKTtcclxufTtcclxuXHJcbih3aW5kb3cgYXMgYW55KS51cGRhdGVCdXR0b24gPSB1cGRhdGVCdXR0b247XHJcbih3aW5kb3cgYXMgYW55KS5oYW5kbGVSb29tQWN0aW9uID0gaGFuZGxlUm9vbUFjdGlvbjtcclxuKHdpbmRvdyBhcyBhbnkpLmhhbmRsZVJlYWR5U3RhdGUgPSBoYW5kbGVSZWFkeVN0YXRlOyIsImltcG9ydCB7IHNob3dFcnJvckFuaW1hdGlvbiwgc2hvd1Jvb21WaWV3LCB1cGRhdGVSb29tTGlzdCB9IGZyb20gXCIuLi9NZW51TWFuYWdlci9sb2dpblwiO1xyXG5cclxubGV0IHNvY2tldDogV2ViU29ja2V0O1xyXG5cclxuZnVuY3Rpb24gaW5pdFdlYlNvY2tldCgpIHtcclxuICAgIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQoYHdzOi8vJHt3aW5kb3cubG9jYXRpb24uaG9zdG5hbWV9OjgwODBgKTtcclxuICAgIFxyXG4gICAgc29ja2V0Lm9ub3BlbiA9ICgpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnV2ViU29ja2V0IGNvbm5lY3Rpb24gZXN0YWJsaXNoZWQnKTtcclxuICAgIH07XHJcblxyXG4gICAgc29ja2V0Lm9ubWVzc2FnZSA9IChldmVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdNZXNzYWdlIGZyb20gc2VydmVyOicsIGRhdGEpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHN3aXRjaCAoZGF0YS50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ0pPSU5FRF9ST09NJzpcclxuICAgICAgICAgICAgICAgIHNob3dSb29tVmlldyhldmVudC5kYXRhKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdST09NX0RPRVNfTk9UX0VYSVNUJzpcclxuICAgICAgICAgICAgICAgIHNob3dFcnJvckFuaW1hdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ1JPT01fREFUQSc6XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVSb29tTGlzdChldmVudC5kYXRhKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdHQU1FUExBWSc6XHJcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGVHYW1lQ2FudmFzKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnRVJST1InOlxyXG4gICAgICAgICAgICAgICAgYWxlcnQoYEVycm9yOiAke2RhdGEubWVzc2FnZX1gKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBcclxuICAgIHNvY2tldC5vbmNsb3NlID0gKCkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdXZWJTb2NrZXQgY29ubmVjdGlvbiBjbG9zZWQnKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHNvY2tldC5vbmVycm9yID0gKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignV2ViU29ja2V0IGVycm9yOicsIGVycm9yKTtcclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSb29tKHVzZXJuYW1lOiBzdHJpbmcpIHtcclxuICAgIGlmIChzb2NrZXQgJiYgc29ja2V0LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7XHJcbiAgICAgICAgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiAnQ1JFQVRFX1JPT00nLCB1c2VybmFtZTogdXNlcm5hbWUgfSkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdXZWJTb2NrZXQgY29ubmVjdGlvbiBpcyBub3Qgb3BlbicpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gam9pblJvb20ocm9vbUNvZGU6IHN0cmluZywgdXNlcm5hbWU6IHN0cmluZykge1xyXG4gICAgaWYgKHNvY2tldCAmJiBzb2NrZXQucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0Lk9QRU4pIHtcclxuICAgICAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7IHR5cGU6ICdKT0lOX1JPT00nLCByb29tQ29kZTogcm9vbUNvZGUsIHVzZXJuYW1lOiB1c2VybmFtZSB9KSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dlYlNvY2tldCBjb25uZWN0aW9uIGlzIG5vdCBvcGVuJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRSZWFkeVN0YXRlKHVzZXJuYW1lOiBzdHJpbmcsIHJvb21Db2RlOiBzdHJpbmcsIHJlYWR5U3RhdGU6IGJvb2xlYW4pIHtcclxuICAgIGlmIChzb2NrZXQgJiYgc29ja2V0LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7XHJcbiAgICAgICAgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiAnU0VUX1JFQURZJywgdXNlcm5hbWU6IHVzZXJuYW1lLCByb29tQ29kZTogcm9vbUNvZGUsIHJlYWR5U3RhdGU6IHJlYWR5U3RhdGV9KSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dlYlNvY2tldCBjb25uZWN0aW9uIGlzIG5vdCBvcGVuJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWFkeVN0YXRlKHVzZXJuYW1lOiBzdHJpbmcpIHtcclxuICAgIGlmIChzb2NrZXQgJiYgc29ja2V0LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7XHJcbiAgICAgICAgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiAnR0VUX1JFQURZJywgdXNlcm5hbWU6IHVzZXJuYW1lIH0pKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignV2ViU29ja2V0IGNvbm5lY3Rpb24gaXMgbm90IG9wZW4nKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNlbmRLZXlFdmVudFRvU2VydmVyKGtleTogc3RyaW5nLCBwcmVzc2VkOiBib29sZWFuKXtcclxuICAgIGlmIChzb2NrZXQgJiYgc29ja2V0LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7XHJcbiAgICAgICAgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiAnS0VZX0VWRU5UJywga2V5OiBrZXksIHByZXNzZWQ6IHByZXNzZWQgfSkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdXZWJTb2NrZXQgY29ubmVjdGlvbiBpcyBub3Qgb3BlbicpO1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxuaW5pdFdlYlNvY2tldCgpO1xyXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcIi4vc3JjL01lbnVNYW5hZ2VyL2xvZ2luLnRzXCIpO1xuIl0sIm5hbWVzIjpbInJvb21Db2RlSW5wdXQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwidXNlcm5hbWVJbnB1dCIsInJvb21CdXR0b24iLCJyZWFkeUJ1dHRvbiIsImxvZ2luRGl2Iiwicm9vbURpdiIsInJvb21Vc2Vyc0xpc3QiLCJyb29tVGl0bGUiLCJwbGF5ZXJDb3VudCIsImlzUmVhZHkiLCJ1cGRhdGVCdXR0b24iLCJ2YWx1ZSIsInRyaW0iLCJkaXNhYmxlZCIsImxlbmd0aCIsInRleHRDb250ZW50IiwiaGFuZGxlUm9vbUFjdGlvbiIsImlubmVyVGV4dCIsImNyZWF0ZVJvb20iLCJqb2luUm9vbSIsInRvVXBwZXJDYXNlIiwiaGFuZGxlUmVhZHlTdGF0ZSIsInNldFJlYWR5U3RhdGUiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJzaG93Um9vbVZpZXciLCJkYXRhIiwicm9vbUluZm8iLCJKU09OIiwicGFyc2UiLCJ0b1N0cmluZyIsImlubmVySFRNTCIsInVwZGF0ZVJvb21MaXN0IiwicGxheWVycyIsImZvckVhY2giLCJwbGF5ZXIiLCJwbGF5ZXJJdGVtIiwiY3JlYXRlRWxlbWVudCIsInVzZXJuYW1lIiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwiYXBwZW5kQ2hpbGQiLCJzaG93RXJyb3JBbmltYXRpb24iLCJzZXRUaW1lb3V0Iiwid2luZG93Iiwib25sb2FkIiwic29ja2V0IiwicmVhZHlTdGF0ZSIsIldlYlNvY2tldCIsIk9QRU4iLCJzZW5kIiwic3RyaW5naWZ5IiwidHlwZSIsImNvbnNvbGUiLCJlcnJvciIsInJvb21Db2RlIiwiZ2V0UmVhZHlTdGF0ZSIsInNlbmRLZXlFdmVudFRvU2VydmVyIiwia2V5IiwicHJlc3NlZCIsImxvY2F0aW9uIiwiaG9zdG5hbWUiLCJvbm9wZW4iLCJsb2ciLCJvbm1lc3NhZ2UiLCJldmVudCIsImFsZXJ0IiwibWVzc2FnZSIsIm9uY2xvc2UiLCJvbmVycm9yIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIl0sInNvdXJjZVJvb3QiOiIifQ==