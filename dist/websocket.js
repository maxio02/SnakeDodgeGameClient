(()=>{"use strict";var t={77:(t,i,n)=>{n.d(i,{DA:()=>u,JC:()=>o,Wu:()=>x,QI:()=>k,Ym:()=>E,xv:()=>S});var e=n(177),s=function(){function t(t,i,n){void 0===i&&(i=!1),this.t=t,this.isReady=i,this.color=n||"#000000".replace(/0/g,(function(){return(~~(16*Math.random())).toString(16)})),this.snake=null}return t.prototype.toJSON=function(){return{username:this.username,isReady:this.isReady,color:this.color}},Object.defineProperty(t.prototype,"username",{get:function(){return this.t},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.snake=null},t}(),r=function(){function t(t,i,n,e){void 0===e&&(e=5),this.i={},this.h=t,this.u=i,this.l=e,n?this.i=n:this.addPlayer(i)}return t.prototype.addPlayer=function(t){return!(Object.keys(this.i).length>=this.l)&&(this.i[t.username]=t,!0)},t.prototype.removePlayer=function(t){delete this.i[t]},t.prototype.resetRoomForNewGame=function(){this.v=1,Object.values(this.i).forEach((function(t){t.reset()}))},Object.defineProperty(t.prototype,"host",{get:function(){return this.u},set:function(t){Object.keys(this.i).some((function(i){return i===t.username}))&&(this.u=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"players",{get:function(){return this.i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.h},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxSize",{get:function(){return this.l},set:function(t){t>0&&(this.l=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastWinner",{get:function(){return this.m},set:function(t){Object.keys(this.i).some((function(i){return i===t.username}))&&(this.m=t)},enumerable:!1,configurable:!0}),t}(),h=n(440),o=null,u=null,c=document.getElementById("roomCodeInput"),a=document.getElementById("usernameInput"),f=document.getElementById("joinButton"),l=document.getElementById("readyButton"),b=document.getElementById("login-div"),d=document.getElementById("room-div"),v=document.getElementById("game-canvas-container"),w=document.getElementById("endgame-div"),m=document.getElementById("color-picker"),p=document.getElementById("room-users-list"),g=document.getElementById("room-code"),O=document.getElementById("player-count"),M=document.getElementById("color-picker-container"),j=document.getElementById("start-progress-bar"),y=document.getElementById("last-winner");function _(){""===a.value.trim()?f.disabled=!0:f.disabled=!1,5===c.value.trim().length?f.textContent="JOIN ROOM":f.textContent="CREATE ROOM"}function A(t){t?(l.classList.remove("red-button"),l.classList.add("green-button")):(l.classList.add("red-button"),l.classList.remove("green-button"))}function k(t){var i=JSON.parse(t.toString()).room,n={};Object.keys(i.players).forEach((function(t){var e=i.players[t];n[t]=new s(t,e.isReady,e.color)})),o=new r(i.code,new s(i.host.username,i.host.isReady,i.host.color),n,i.maxSize),u.username===o.host.username&&document.getElementById("startButton").classList.remove("display-none"),M.style.backgroundColor=u.color,m.value=u.color,document.getElementById("color-label").style.color=T(m.value,"#FFFFFF","#000000"),b.classList.add("display-none"),d.classList.add("display-flex"),c.value=o.code,g.innerHTML=o.code,(0,h.AQ)(u,o.code),S(t)}function S(t){var i=JSON.parse(t.toString()).room;Object.keys(i.players).forEach((function(t){null==o.players[t]?o.addPlayer(new s(t,!1,i.players[t].color)):(o.players[t].color=i.players[t].color,o.players[t].isReady=i.players[t].isReady)})),Object.keys(o.players).forEach((function(t){i.players.hasOwnProperty(t)||o.removePlayer(t)})),o.host=new s(i.host.username,i.host.isReady,i.host.color),o.maxSize=i.maxSize,O.innerHTML="".concat(Object.keys(o.players).length,"/").concat(o.maxSize),p.innerHTML="",Object.values(o.players).forEach((function(t){var i=document.createElement("li");i.textContent=t.username+"",t.username===o.host.username?i.insertAdjacentHTML("afterbegin",'<i class="fa-solid fa-crown" style="color: '.concat(t.color,';"></i>')):i.insertAdjacentHTML("afterbegin",'<i class="fa-solid fa-circle" style="color: '.concat(t.color,'; margin-left: 4px"></i>')),t.isReady?i.insertAdjacentHTML("beforeend",' <i class="fa-solid fa-circle" style="color: #37cb48;"></i>'):i.insertAdjacentHTML("beforeend",' <i class="fa-solid fa-circle" style="color: #cb3737;"></i>'),p.appendChild(i)})),u.username===o.host.username&&document.getElementById("startButton").classList.remove("display-none"),function(t,i){if(0===i)return;j.style.width=Math.floor(t/i*100)+"%"}(Object.values(o.players).filter((function(t){return t.isReady})).length,o.maxSize)}function x(t){f.classList.add("red-button"),f.classList.add("wiggle"),setTimeout((function(){f.classList.remove("red-button"),f.classList.remove("wiggle")}),600)}function T(t,i,n){var e="#"===t.charAt(0)?t.substring(1,7):t,s=[parseInt(e.substring(0,2),16)/255,parseInt(e.substring(2,4),16)/255,parseInt(e.substring(4,6),16)/255].map((function(t){return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}));return.2126*s[0]+.7152*s[1]+.0722*s[2]>.4?n:i}function E(t){switch(t.state){case 0:b.classList.add("display-none"),d.classList.add("display-none"),d.classList.remove("display-flex"),v.classList.remove("display-none"),v.classList.add("display-flex"),(0,e.Pp)();break;case 1:b.classList.add("display-none"),b.classList.remove("display-flex"),d.classList.add("display-flex"),w.classList.add("display-none"),w.classList.remove("display-flex");break;case 2:y.innerHTML="".concat(o.lastWinner.username),v.classList.add("display-none"),v.classList.remove("display-flex"),w.classList.add("display-flex")}}window.onload=function(){_()},window.updateButton=_,window.handleRoomAction=function(){var t=a.value;t&&(u=new s(t),"CREATE ROOM"===f.innerText?(0,h.ab)(a.value):(0,h.O3)(c.value.toUpperCase(),a.value))},window.handleReadyState=function(){u.isReady=!u.isReady,(0,h.AQ)(u,o.code),A(u.isReady)},window.updateColorPicker=function(){M.style.backgroundColor=m.value},window.updatePlayerColor=function(){u.color=m.value,document.getElementById("color-label").style.color=T(m.value,"#FFFFFF","#000000"),(0,h.AQ)(u,o.code)},window.startGame=function(){u.username==o.host.username&&(0,h.w4)(o.code)},window.goBackToLobby=function(){E({type:"GAME_STATE",state:1}),o.resetRoomForNewGame(),u.snake=null,u.isReady=!1,A(u.isReady)}},440:(t,i,n)=>{n.d(i,{AQ:()=>u,O3:()=>o,Uj:()=>c,ab:()=>h,w4:()=>a});var e,s=n(177),r=n(77);function h(t){e&&e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({type:"CREATE_ROOM",username:t}))}function o(t,i){e&&e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({type:"JOIN_ROOM",roomCode:t,username:i}))}function u(t,i){e&&e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({type:"PLAYER_DATA",player:t,roomCode:i}))}function c(t,i){e&&e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({type:"KEY_EVENT",roomCode:r.JC.code,username:r.DA.username,key:t,pressed:i}))}function a(t){e&&e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({type:"BEGIN_GAME",roomCode:t}))}(e=new WebSocket("wss://snakegame-server.maxio.site")).onopen=function(){},e.onmessage=function(t){var i=JSON.parse(t.data);switch(i.type){case"JOINED_ROOM":(0,r.QI)(t.data);break;case"JOIN_FAIL":(0,r.Wu)(i.reason);break;case"ROOM_DATA":(0,r.xv)(t.data);break;case"GAME_STATE":(0,r.Ym)(i);break;case"GAMEPLAY_DATA":(0,s.XK)(i);break;case"ERROR":alert("Error: ".concat(i.message))}},e.onclose=function(){},e.onerror=function(t){}},177:(t,i,n)=>{n.d(i,{Ze:()=>L,K7:()=>B,jG:()=>W,C0:()=>D,oZ:()=>z,Pp:()=>Y,XK:()=>Z});var e=n(565);function s(){var t=B.canvas.width/2e3,i=B.canvas.height/2e3;B.clearRect(0,0,L.width,L.height),B.strokeStyle="rgba(0, 0, 0, 0.3)",B.lineWidth=2;for(var n=z*t;n<L.width;n+=z*t)B.beginPath(),B.moveTo(n,0),B.lineTo(n,L.height),B.stroke();for(var e=z*i;e<L.height;e+=z*i)B.beginPath(),B.moveTo(0,e),B.lineTo(L.width,e),B.stroke()}const r=function(){};var h,o=(h=function(t,i){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},h(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});const u=function(t){function i(i,n,e,s,r,h){var o=t.call(this)||this;return o.center=i,o.radius=n,o.startAngle=e,o.endAngle=s,o.p=r,o.isCollidable=h,o}return o(i,t),i.prototype.draw=function(t,i){var n=t.canvas.width/2e3,e=t.canvas.height/2e3;t.lineCap="round",t.strokeStyle=i,!0===this.isCollidable&&(t.beginPath(),t.arc(this.center.x*n,this.center.y*e,this.radius*Math.min(n,e),this.startAngle,this.endAngle,this.p),t.stroke(),t.closePath())},i.prototype.drawDebug=function(t,i){var n,s,r,h,o=this.p?-Math.PI:Math.PI;o+=this.endAngle,t.lineCap="round",function(t,i,n,e){B.beginPath(),B.arc(t,i,n,0,2*Math.PI,!1),B.fillStyle=e,B.fill(),B.closePath()}(this.center.x,this.center.y,5,"#000000"),function(t,i,n){if(i.x!=n.x&&i.y!=n.y){var s=Math.atan2(n.y-i.y,n.x-i.x),r=10,h=new e.Vector(n.x,n.y);h.x-=11.5*Math.cos(s),h.y-=11.5*Math.sin(s),t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(h.x,h.y),t.strokeStyle="#bbbbbb",t.lineWidth=10,t.stroke(),t.beginPath(),t.moveTo(h.x,h.y),t.lineTo(h.x-r*Math.cos(s-Math.PI/7),h.y-r*Math.sin(s-Math.PI/7)),t.lineTo(h.x-r*Math.cos(s+Math.PI/7),h.y-r*Math.sin(s+Math.PI/7)),t.lineTo(h.x,h.y),t.lineTo(h.x-r*Math.cos(s-Math.PI/7),h.y-r*Math.sin(s-Math.PI/7)),t.strokeStyle="#bbbbbb",t.lineWidth=10,t.stroke(),t.fillStyle="#bbbbbb",t.fill(),t.closePath()}}(t,new e.Vector(this.endPoint.x,this.endPoint.y),new e.Vector(this.endPoint.x+this.radius*Math.cos(o),this.endPoint.y+this.radius*Math.sin(o))),n=this.center.x,s=this.center.y,r=this.radius,h=!1,B.lineCap="round",B.strokeStyle="#3466aa",B.beginPath(),B.arc(n,s,r,0,2*Math.PI,h),B.lineWidth=5,B.stroke(),B.closePath()},Object.defineProperty(i.prototype,"endPoint",{get:function(){return new e.Vector(this.center.x+this.radius*Math.cos(this.endAngle),this.center.y+this.radius*Math.sin(this.endAngle))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"penpendicularEndAngle",{get:function(){return this.isCounterClockwise?this.endAngle-Math.PI/2:this.endAngle+Math.PI/2},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"penpendicularStartAngle",{get:function(){return this.isCounterClockwise?this.startAngle-Math.PI/2:this.startAngle+Math.PI/2},enumerable:!1,configurable:!0}),i.prototype.isCounterClockwise=function(){return this.p},i.prototype.getContinuingSegment=function(t){return new i(this.center.clone().add(t),this.radius,this.endAngle,this.endAngle,this.p,this.isCollidable)},i}(r);var c=n(440);const a=function(){function t(t,i,n){this.O={},window.addEventListener("keydown",this.onKeyDown.bind(this)),window.addEventListener("keyup",this.onKeyUp.bind(this)),this.M=t,this.j=i.map((function(t){return t.toUpperCase()})),this._=n.map((function(t){return t.toUpperCase()}))}return t.prototype.onKeyDown=function(t){var i=this;if(this.M.isAlive){var n=t.key.toUpperCase();if(this.j.includes(n)||this._.includes(n)){if(this.j.some((function(t){return i.O[t]}))&&this._.includes(n))this.j.forEach((function(t){return i.O[t]=!1}));else if(this._.some((function(t){return i.O[t]}))&&this.j.includes(n))this._.forEach((function(t){return i.O[t]=!1}));else if(this.O[n])return;this.O[n]=!0,(0,c.Uj)(this._.includes(n)?1:0,!0)}}},t.prototype.onKeyUp=function(t){if(this.M.isAlive){var i=t.key.toUpperCase();this.O[i]&&(this.O[i]=!1,(0,c.Uj)(this._.includes(i)?1:0,!1))}},t.prototype.dispose=function(){window.removeEventListener("keydown",this.onKeyDown.bind(this)),window.removeEventListener("keyup",this.onKeyUp.bind(this))},t}();var f=function(){var t=function(i,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},t(i,n)};return function(i,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();const l=function(t){function i(i,n,e,s){var r=t.call(this)||this;return r.isCollidable=!0,r.startPoint=i,r.endPoint=n,r.isCollidable=e,r.endAngle=s,r}return f(i,t),i.prototype.draw=function(t,i){var n=t.canvas.width/2e3,e=t.canvas.height/2e3;t.strokeStyle=i,t.lineCap="round",!0===this.isCollidable&&(t.beginPath(),t.moveTo(this.startPoint.x*n,this.startPoint.y*e),t.lineTo(this.endPoint.x*n,this.endPoint.y*e),t.stroke(),t.closePath())},Object.defineProperty(i.prototype,"length",{get:function(){return Math.sqrt(Math.pow(this.startPoint.x-this.endPoint.x,2)+Math.pow(this.startPoint.y-this.endPoint.y,2))},enumerable:!1,configurable:!0}),i.prototype.getContinuingSegment=function(t){var n=this.endPoint.clone().add(t);return new i(n,n,this.isCollidable,this.endAngle)},i}(r);function b(t,i){var n;return function(t){return new e.Vector(Math.cos(t),Math.sin(t))}((n=t,Math.atan2(n.y,n.x)+(Math.random()-.5)*i))}function d(t,i){var n;do{n=new e.Vector(Math.random()*t*2-t,Math.random()*t*2-t)}while(Math.pow(n.x,2)+Math.pow(n.y,2)>Math.pow(t,2));return i&&n.normalise().mulS(t),n}function v(t){var i=0,n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(t);return i=void 0===n[4]?1:parseInt(n[4],16)/255,n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16),a:i}:null}var w=function(){return w=Object.assign||function(t){for(var i,n=1,e=arguments.length;n<e;n++)for(var s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t},w.apply(this,arguments)};const m=function(){function t(t,i,n,e,s,r,h,o,u,c,a){void 0===s&&(s="circle"),this.A=t,this.k=i,this.S=o,this.T=r.a/this.S,this.I=n/this.S,"reverse"===a?(this.R=0,this.F=w(w({},function(t){return{r:t.r,g:t.g,b:t.b}}(r)),{a:0})):(this.R=n,this.F=r),this.C=e,this.N=s,this.J=h,this.P=u,this.W=c,this.D=a}return t.prototype.tick=function(t){this.A.add(this.k.clone().multiplyByScalar(t*this.C)),this.P&&("normal"===this.D?this.F.a-=this.T:this.F.a+=this.T),this.W&&("normal"===this.D?this.R-=this.I:this.R+=this.I),this.S--},t.prototype.draw=function(){var t=this.J.canvas.width/2e3,i=this.J.canvas.height/2e3;switch(this.J.moveTo(this.A.x*t,this.A.y*i),this.J.fillStyle="rgba(".concat(this.F.r,",").concat(this.F.g,", ").concat(this.F.b,", ").concat(this.F.a,")"),this.J.beginPath(),this.N){case"circle":this.J.arc(this.A.x*t,this.A.y*i,this.R,0,2*Math.PI),this.J.fill();break;case"square":this.J.fillRect((this.A.x-this.R)*t,(this.A.y-this.R)*i,2*this.R,2*this.R)}this.J.closePath()},Object.defineProperty(t.prototype,"age",{get:function(){return this.S},enumerable:!1,configurable:!0}),t}();var p=function(){function t(t,i,n){var s=n.emitInterval,r=void 0===s?2:s,h=n.emitAmountPerTick,o=void 0===h?5:h,u=n.particleSize,c=void 0===u?10:u,a=n.speed,f=void 0===a?2:a,l=n.particleShape,b=void 0===l?"circle":l,d=n.color,v=void 0===d?"#ffffffff":d,w=n.doFadeColor,m=void 0===w||w,p=n.doFadeSize,g=void 0===p||p,O=n.fadeDirection,M=void 0===O?"normal":O,j=n.particleAge,y=void 0===j?50:j,_=n.emitTimeMillis,A=void 0===_?0:_,k=n.drawEmitterZone,S=void 0!==k&&k,x=n.emitDirection,T=void 0===x?new e.Vector(0,0):x,E=n.spreadAngle,I=void 0===E?2*Math.PI:E,R=n.spawnParticlesOnEdge,F=void 0!==R&&R;this.L=[],this.B=0,this.position=t,this.J=i,this.G=r,this.Y=o,this.K=c,this.C=f,this.q=b,this.F=v,this.U=m,this.Z=g,this.D=M,this.$=y,this.H=I,this.V=A,this.emitDirection=T,this.X=S,this.tt=F}return Object.defineProperty(t.prototype,"emitTime",{set:function(t){this.V=t},enumerable:!1,configurable:!0}),t}();const g=p;var O=function(){var t=function(i,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},t(i,n)};return function(i,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),M=function(){return M=Object.assign||function(t){for(var i,n=1,e=arguments.length;n<e;n++)for(var s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t},M.apply(this,arguments)};const j=function(t){function i(i,n,e,s){var r=t.call(this,n,e,s)||this;return r.it=i,r}return O(i,t),i.prototype.tick=function(t){if(!(this.V+this.$<0)){if(this.V-=t,this.B%this.G==0&&this.V>0)for(var i=this.J.canvas.height/2e3,n=0;n<this.Y;n++)this.L.push(new m(this.position.clone().add(d(this.it,this.tt)),b(this.emitDirection,this.H),this.K*i,this.C,this.q,M({},v(this.F)),this.J,this.$,this.U,this.Z,this.D));this.L.forEach((function(i){i.tick(t)})),this.L=this.L.filter((function(t){return t.age>0})),this.B++}},i.prototype.draw=function(){if(!(this.V+this.$<0)){if(!0===this.X){var t=v(this.F),i=this.J.canvas.width/2e3,n=this.J.canvas.height/2e3;this.J.moveTo(this.position.x*i,this.position.y*n),this.J.fillStyle="rgba(".concat(t.r,",").concat(t.g,",").concat(t.b,", ").concat(Math.min(.2,(this.V+this.$)/this.$/5),")"),this.J.beginPath(),this.J.arc(this.position.x*i,this.position.y*n,this.it,0,2*Math.PI),this.J.fill(),this.J.closePath()}this.L.forEach((function(t){t.draw()}))}},Object.defineProperty(i.prototype,"emitTime",{set:function(t){this.V=t},enumerable:!1,configurable:!0}),i}(g);const y=function(){function t(t,i,n){this.segments=[],this.isAlive=!0,this.turnRadius=60,this.nt=null,this.addSegment(t),this.F=i,this.J=n,this.nt=new j(0,this.head.endPoint,this.J,{emitInterval:2,emitAmountPerTick:3,particleSize:7,speed:4,color:this.F})}return t.prototype.addSegment=function(t){this.segments.push(t)},Object.defineProperty(t.prototype,"head",{get:function(){return this.segments.slice(-1).pop()},enumerable:!1,configurable:!0}),t.prototype.draw=function(){var t=this,i=this.J.canvas.width/2e3,n=this.J.canvas.height/2e3;this.J.lineWidth=12*Math.min(i,n),this.segments.forEach((function(e,s){e.draw(t.J,t.F),t.head===e&&(t.J.beginPath(),t.J.arc(e.endPoint.x*i,e.endPoint.y*n,.5*Math.min(i,n),0,2*Math.PI),t.J.stroke(),t.J.closePath())}))},t.prototype.kill=function(){this.isAlive=!1,this.nt.position=this.head.endPoint,this.nt.emitTime=10},t.prototype.updateEmitter=function(t){this.nt&&(this.nt.tick(t),this.nt.draw())},t}();var _=n(77),A=function(){var t=function(i,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},t(i,n)};return function(i,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),k=function(){return k=Object.assign||function(t){for(var i,n=1,e=arguments.length;n<e;n++)for(var s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t},k.apply(this,arguments)};const S=function(t){function i(i,n,e,s,r){var h=t.call(this,e,s,r)||this;return h.et=i,h.st=n,h}return A(i,t),i.prototype.tick=function(t){if(!(this.V+this.$<0)){if(this.V-=t,this.B%this.G==0&&this.V>0)for(var i=this.J.canvas.height/2e3,n=0;n<this.Y;n++)this.L.push(new m(this.position.clone().add((s=this.et,r=this.st,new e.Vector(Math.random()*s,Math.random()*r)).subtract(new e.Vector(this.et/2,this.st/2))),b(this.emitDirection,this.H),this.K*i,this.C,this.q,k({},v(this.F)),this.J,this.$,this.U,this.Z,this.D));var s,r;this.L.forEach((function(i){i.tick(t)})),this.L=this.L.filter((function(t){return t.age>0})),this.B++}},i.prototype.draw=function(){if(!(this.V+this.$<0)){if(!0===this.X){var t=this.J.canvas.width/2e3,i=this.J.canvas.height/2e3;this.J.moveTo((this.position.x-this.et/2)*t,(this.position.y-this.st/2)*i),this.J.fillStyle="rgba(".concat((n=this.F,e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n),e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null),", ").concat(Math.min(.2,(this.V+this.$)/this.$/5),")"),this.J.beginPath(),this.J.rect(this.position.x-this.et/2,this.position.y-this.st/2,this.et,this.st),this.J.fill(),this.J.closePath()}var n,e;this.L.forEach((function(t){t.draw()}))}},Object.defineProperty(i.prototype,"emitTime",{set:function(t){this.V=t},enumerable:!1,configurable:!0}),i}(g);var x,T;!function(t){t[t.SpeedUp=0]="SpeedUp",t[t.SpeedDown=1]="SpeedDown",t[t.Bomb=2]="Bomb",t[t.FlipButtons=3]="FlipButtons",t[t.Invisibility=4]="Invisibility",t[t.PortalWalls=5]="PortalWalls",t[t.CameraLockToPlayer=6]="CameraLockToPlayer"}(T||(T={}));var E=((x={})[T.SpeedUp]="../assets/powerups/speedup.svg",x[T.SpeedDown]="../assets/powerups/speeddown.svg",x[T.Bomb]="../assets/powerups/bomb.svg",x[T.FlipButtons]="../assets/powerups/flipbuttons.svg",x[T.Invisibility]="../assets/powerups/invisibility.svg",x[T.PortalWalls]="../assets/powerups/portalwalls.svg",x[T.CameraLockToPlayer]="../assets/powerups/temp.svg",x);const I=function(){function t(t,i,n,e,s,r){this.rt=30,this.ht=t,this.A=i,this.J=n,this.F=e,this.ot=s,this.ut=r,this.ct=new Image,this.ct.src=E[this.ot],this.nt=new j(.6*this.rt,this.A,this.J,{color:this.F,particleSize:this.rt/2.85,particleAge:60,speed:this.rt/20,emitAmountPerTick:3,spawnParticlesOnEdge:!0})}return t.prototype.draw=function(){this.nt.tick(.5),this.nt.draw();var t=this.J.canvas.width/2e3,i=this.J.canvas.height/2e3;this.J.moveTo(this.A.x*t,this.A.y*i),this.J.fillStyle=this.F,this.J.beginPath(),this.J.arc(this.A.x*t,this.A.y*i,this.rt*t,0,2*Math.PI),this.J.fill(),this.J.closePath(),this.drawSVG(),this.nt.emitTime=1/0},t.prototype.drawSVG=function(){var t=this.J.canvas.width/2e3,i=this.J.canvas.height/2e3,n=.6,e=this.ct.width/this.ct.height,s=2*this.rt*n*t,r=2*this.rt*n*t/e;r>2*this.rt*n*t&&(s=(r=2*this.rt*n*t)*e),this.J.drawImage(this.ct,this.A.x*t-s/2,this.A.y*i-r/2,s,r)},Object.defineProperty(t.prototype,"id",{get:function(){return this.ht},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.A},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this.rt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.ot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.F},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.ut},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{id:this.ht,position:{x:this.position.x,y:this.position.y},color:this.F,type:this.ot,radius:this.rt,duration:this.ut}},t.fromMessagePowerup=function(i,n){return new t(i.powerup.id,new e.Vector(i.powerup.position.x,i.powerup.position.y),n,i.powerup.color,i.powerup.type,i.powerup.duration)},t}();var R=function(){function t(){this.ft={},this.lt=[],this.bt=!1,this.dt=!1,this.vt=document.getElementById("game-canvas-container"),this.initializeWallEmitters()}return t.prototype.initializeWallEmitters=function(){for(var t=[new e.Vector(2e3,50),new e.Vector(50,2e3),new e.Vector(2e3,50),new e.Vector(50,2e3)],i=[new e.Vector(0,-1),new e.Vector(-1,0),new e.Vector(0,1),new e.Vector(1,0)],n=[new e.Vector(1e3,50),new e.Vector(50,1e3),new e.Vector(1e3,1950),new e.Vector(1950,1e3)],s=0;s<4;s++)this.lt.push(new S(t[s].x,t[s].y,n[s],D,{particleShape:"square",color:"#59eeebff",emitTimeMillis:0,emitDirection:i[s],spreadAngle:Math.PI/6,speed:.8,particleSize:8,particleAge:100,emitInterval:1,emitAmountPerTick:4,fadeDirection:"reverse"}))},t.prototype.addPowerup=function(t){this.ft[t.id]=t},t.prototype.removePowerup=function(t){delete this.ft[t.id]},t.prototype.applyPowerup=function(t,i){var n=this;switch(t.type){case T.PortalWalls:this.flipWallState(),setTimeout((function(){n.flipWallState()}),t.duration);break;case T.CameraLockToPlayer:if(i.username===_.DA.username||!_.DA.snake.isAlive)break;this.dt=!0,W.width=2*W.getBoundingClientRect().width,W.height=2*W.getBoundingClientRect().height,L.width=2*L.getBoundingClientRect().width,L.height=2*L.getBoundingClientRect().height,document.getElementById("login-screen-body").style.overflow="hidden",s(),setTimeout((function(){n.dt=!1,document.getElementById("game-canvas-container").style.transform="scale(1) rotate(0rad) translate(0px, 0px)",setTimeout((function(){document.getElementById("login-screen-body").style.overflow="visible",Y()}),200)}),t.duration)}this.removePowerup(t)},t.prototype.generateZones=function(t,i){},t.prototype.draw=function(){Object.values(this.ft).forEach((function(t){t.draw()})),this.lt.forEach((function(t){t.tick(1),t.draw()}))},t.prototype.flipWallState=function(){var t=this;this.bt=!this.bt,this.lt.forEach((function(i){return i.emitTime=t.bt?1/0:0})),this.vt.style.borderColor=this.bt?"#34c6dc":"#555555"},Object.defineProperty(t.prototype,"cameraLock",{get:function(){return this.dt},enumerable:!1,configurable:!0}),t}();const F=R;var C=document.getElementById("game-canvas-container"),N=document.createElement("div");N.style.position="absolute",N.style.top="10px",N.style.left="10px",N.style.color="black";var J=0;document.body.appendChild(N);var P=60,W=document.getElementById("game-canvas"),D=W.getContext("2d"),L=document.getElementById("background-canvas"),B=L.getContext("2d");L.width=L.getBoundingClientRect().width,L.height=L.getBoundingClientRect().height,W.width=W.getBoundingClientRect().width,W.height=W.getBoundingClientRect().height;var G,z=66.666;function Y(){W.width=W.getBoundingClientRect().width,W.height=W.getBoundingClientRect().height,L.width=L.getBoundingClientRect().width,L.height=L.getBoundingClientRect().height,s()}function K(){++q%10==0&&(P=function(){var t=performance.now()/10,i=t-Q,n=Math.round(1e3/i);return Q=t,n}(),N.innerText="FPS: ".concat(P)),D.clearRect(0,0,W.width,W.height),Object.values(_.JC.players).forEach((function(t){t.snake.draw(),t.snake.updateEmitter((performance.now()/10-Q)/15)})),G.draw()}var q=0,Q=performance.now()/10;function U(t,i){var n=2*Math.PI,e=(i-t)%n;return e>Math.PI?e-=n:e<-Math.PI&&(e+=n),t+e}function Z(t){if(null===_.DA.snake)t.snakeHeads.forEach((function(t){var i=t.lastSegment,n=t.username,s=i.endPoint;_.JC.players[n].snake=new y(new l(new e.Vector(s.x,s.y),new e.Vector(s.x,s.y),i.isCollidable,i.endAngle),_.JC.players[n].color,D)})),_.DA.snake=_.JC.players[_.DA.username].snake,new a(_.JC.players[_.DA.username].snake,["A","ARROWLEFT"],["D","ARROWRIGHT"]),G=new F;else{var i=[];t.snakeHeads.forEach((function(n){var s=n.lastSegment,r=n.username,h=s.endPoint,o=_.JC.players[r].snake;if(null!==t.powerupList&&t.powerupList.forEach((function(t){switch(t.action){case 0:G.removePowerup(I.fromMessagePowerup(t,D));break;case 1:G.addPowerup(I.fromMessagePowerup(t,D));break;case 2:G.applyPowerup(I.fromMessagePowerup(t,D),t.player)}})),i.push(r),s.isNewThisTick){if("LineSegment"===n.segmentType){var c=s.startPoint;o.addSegment(new l(new e.Vector(c.x,c.y),new e.Vector(h.x,h.y),s.isCollidable,s.endAngle))}else if("ArcSegment"===n.segmentType){var a=s.center;o.addSegment(new u(new e.Vector(a.x,a.y),s.radius,s.startAngle,s.endAngle,s.counterClockwise,s.isCollidable))}}else if("LineSegment"===n.segmentType){if(G.cameraLock&&r===_.DA.username){var f=-s.endAngle-Math.PI/2,b=U(J,f);C.style.transform="scale(2) rotate(".concat(b,"rad) translate(").concat(-s.endPoint.x*window.innerHeight/2e3+window.innerHeight/2,"px, ").concat(-s.endPoint.y*window.innerHeight/2e3+window.innerHeight/2,"px)"),J=b}c=s.startPoint;o.segments[o.segments.length-1]=new l(new e.Vector(c.x,c.y),new e.Vector(h.x,h.y),s.isCollidable,s.endAngle)}else if("ArcSegment"===n.segmentType){if(G.cameraLock&&r===_.DA.username){f=s.counterClockwise?-s.endAngle:-s.endAngle-Math.PI,b=U(J,f);C.style.transform="scale(2) rotate(".concat(b,"rad) translate(").concat(-s.endPoint.x*window.innerHeight/2e3+window.innerHeight/2,"px, ").concat(-s.endPoint.y*window.innerHeight/2e3+window.innerHeight/2,"px)"),J=b}a=s.center;o.segments[o.segments.length-1]=new u(new e.Vector(a.x,a.y),s.radius,s.startAngle,s.endAngle,s.counterClockwise,s.isCollidable)}})),Object.values(_.JC.players).forEach((function(t){!i.includes(t.username)&&t.snake.isAlive&&(t.snake.kill(),!0===Object.values(_.JC.players).every((function(t){return!t.snake.isAlive}))&&(_.JC.lastWinner=t))}))}K()}window.addEventListener("resize",Y),s()},120:(t,i)=>{Object.defineProperty(i,"wt",{value:!0});var n=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10],e=function(){function t(t){this.ctor=t}return t.prototype.setAxes=function(t,i){return this.x=t,this.y=i,this},t.prototype.getX=function(){return this.x},t.prototype.setX=function(t){return this.x=t,this},t.prototype.getY=function(){return this.y},t.prototype.setY=function(t){return this.y=t,this},t.prototype.toString=function(t){return void 0===t&&(t=!1),t?"("+Math.round(this.x)+", "+Math.round(this.y)+")":"("+this.x+", "+this.y+")"},t.prototype.toArray=function(){return[this.x,this.y]},t.prototype.toObject=function(){return{x:this.x,y:this.y}},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.multiplyByVector=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.mulV=function(t){return this.multiplyByVector(t)},t.prototype.divideByVector=function(t){return this.x/=t.x,this.y/=t.y,this},t.prototype.divV=function(t){return this.divideByVector(t)},t.prototype.multiplyByScalar=function(t){return this.x*=t,this.y*=t,this},t.prototype.mulS=function(t){return this.multiplyByScalar(t)},t.prototype.divideByScalar=function(t){return this.x/=t,this.y/=t,this},t.prototype.divS=function(t){return this.divideByScalar(t)},t.prototype.normalise=function(){return this.divideByScalar(this.magnitude())},t.prototype.normalize=function(){return this.normalise()},t.prototype.unit=function(){return this.normalise()},t.prototype.magnitude=function(){var t=this.x,i=this.y;return Math.sqrt(t*t+i*i)},t.prototype.length=function(){return this.magnitude()},t.prototype.lengthSq=function(){var t=this.x,i=this.y;return t*t+i*i},t.prototype.dot=function(t){return t.x*this.x+t.y*this.y},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.abs=function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},t.prototype.zero=function(){return this.x=this.y=0,this},t.prototype.distance=function(t){var i=this.x-t.x,n=this.y-t.y;return Math.sqrt(i*i+n*n)},t.prototype.rotate=function(t){var i=Math.cos(t),n=Math.sin(t),e=this.x,s=this.y;return this.x=e*i-s*n,this.y=e*n+s*i,this},t.prototype.round=function(t){void 0===t&&(t=2);var i=n[t];return this.x=(.5+this.x*i<<0)/i,this.y=(.5+this.y*i<<0)/i,this},t.prototype.clone=function(){return new this.ctor(this.x,this.y)},t}();i.AbstractVector=e},51:function(t,i,n){var e,s=this&&this.gt||(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"wt",{value:!0});var r=function(t){function i(n,e){var s=t.call(this,i)||this;return s.axes=[n,e],s.ctor=i,s}return s(i,t),Object.defineProperty(i.prototype,"x",{get:function(){return this.axes[0]},set:function(t){this.axes[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this.axes[1]},set:function(t){this.axes[1]=t},enumerable:!0,configurable:!0}),i}(n(120).AbstractVector);i.ArrayVector=r},725:function(t,i,n){var e,s=this&&this.gt||(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"wt",{value:!0});var r=function(t){function i(n,e){var s=t.call(this,i)||this;return s.axes=new Float32Array(2),s.axes[0]=n,s.axes[1]=e,s}return s(i,t),Object.defineProperty(i.prototype,"x",{get:function(){return this.axes[0]},set:function(t){this.axes[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this.axes[1]},set:function(t){this.axes[1]=t},enumerable:!0,configurable:!0}),i}(n(120).AbstractVector);i.Float32Vector=r},565:(t,i,n)=>{function e(t){for(var n in t)i.hasOwnProperty(n)||(i[n]=t[n])}Object.defineProperty(i,"wt",{value:!0}),e(n(120)),e(n(51)),e(n(725)),e(n(974))},974:function(t,i,n){var e,s=this&&this.gt||(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"wt",{value:!0});var r=function(t){function i(n,e){var s=t.call(this,i)||this;return s.Ot=n,s.Mt=e,s}return s(i,t),Object.defineProperty(i.prototype,"x",{get:function(){return this.Ot},set:function(t){this.Ot=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this.Mt},set:function(t){this.Mt=t},enumerable:!0,configurable:!0}),i}(n(120).AbstractVector);i.Vector=r}},i={};function n(e){var s=i[e];if(void 0!==s)return s.exports;var r=i[e]={exports:{}};return t[e].call(r.exports,r,r.exports,n),r.exports}n.d=(t,i)=>{for(var e in i)n.o(i,e)&&!n.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})},n.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i);n(440)})();